<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>üõçÔ∏è Cat√°logo MacDavis - Nova Vers√£o</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="PNG MD.png">
    <link rel="apple-touch-icon" href="PNG MD.png">
    
    <!-- Performance Optimizations -->
    <link rel="dns-prefetch" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
    <link rel="preload" href="catalog-styles-dark-modern.css" as="style">
    
    <!-- ANTI-CACHE HEADERS -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate, max-age=0">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <!-- üé® CSS TEMA ESCURO MODERNO -->
    <!-- DESABILITADO EM MOBILE - Causava travamento de scroll -->
    <link rel="stylesheet" href="catalog-styles-dark-modern.css?v=20260121230500" media="(min-width: 1025px)">
    <link rel="stylesheet" href="CSS.css?v=20260115154950" media="(min-width: 1025px)">
    
    <!-- üéØ Sistema de Notifica√ß√µes Toast -->
    <link rel="stylesheet" href="toast-notifications.css?v=20260116">
    <link rel="stylesheet" href="page-transitions.css?v=20260104c">

    <!-- üì± MOBILE MINIMAL - CSS Mobile MINIMALISTA (N√ÉO trava scroll) -->
    <link rel="stylesheet" href="mobile-minimal.css?v=20260125008">
    <!-- ü¶ä FIREFOX PERFORMANCE FIX -->
    <link rel="stylesheet" href="firefox-performance-fix.css?v=20260114">
    <!-- ‚ö° SMART LOADING - Sistema de loading inteligente -->
    <link rel="stylesheet" href="smart-loading.css?v=20260114">
    <!-- ‚ö° SMART LOADING JS - Carregar ANTES de tudo -->
    <script src="smart-loading.js?v=20260114"></script>

    
    <!-- ÔøΩ FIX SCROLL CR√çTICO - INLINE COM M√ÅXIMA PRIORIDADE -->
    <style>
        @media (max-width: 1024px) {
            html {
                overflow: auto !important;
                overflow-x: hidden !important;
                overflow-y: auto !important;
                position: static !important;
                height: auto !important;
            }
            body {
                overflow: auto !important;
                overflow-x: hidden !important;
                overflow-y: auto !important;
                position: static !important;
                height: auto !important;
                touch-action: pan-y !important;
            }
        }
    </style>
    
    <!-- ÔøΩüöÄ GRID 2x2 FOR√áADO - INLINE -->
    <script>
    if (window.innerWidth <= 900) {
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(() => {
                window.openMotoPanel = function(id) {
                    const m = window.motorcycles?.find(x => x.id === id);
                    if (!m) return;
                    
                    const s = document.createElement('div');
                    s.style.cssText = 'position:fixed;inset:0;z-index:9999;background:rgba(0,0,0,0.7)';
                    
                    const content = document.createElement('div');
                    content.style.cssText = 'position:absolute;bottom:0;left:0;right:0;max-height:55vh;background:#1a1a1a;border-radius:24px 24px 0 0;padding:12px;overflow-y:auto';
                    
                    // Handle
                    const handle = document.createElement('div');
                    handle.style.cssText = 'width:40px;height:4px;background:rgba(255,255,255,0.3);border-radius:2px;margin:0 auto 12px';
                    content.appendChild(handle);
                    
                    // T√≠tulo
                    const title = document.createElement('h2');
                    title.style.cssText = 'margin:0 0 12px;font-size:0.95rem;color:#fff';
                    title.textContent = (m.marca||'') + ' ' + (m.name||m.nome||'');
                    content.appendChild(title);
                    
                    // Imagem
                    if (m.image) {
                        const img = document.createElement('img');
                        img.src = m.image;
                        img.style.cssText = 'width:100%;max-height:120px;object-fit:cover;border-radius:12px;margin-bottom:10px';
                        content.appendChild(img);
                    }
                    
                    // GRID 2x2 - DIRETO VIA DOM
                    const grid = document.createElement('div');
                    grid.style.display = 'grid';
                    grid.style.gridTemplateColumns = '1fr 1fr';
                    grid.style.gap = '8px';
                    grid.style.marginBottom = '14px';
                    
                    const specs = [
                        {label: 'üìÖ Ano', value: m.year||m.ano||'N/A'},
                        {label: 'üé® Cor', value: m.color||m.cor||'N/A'},
                        {label: 'üìè KM', value: ((m.mileage||m.quilometragem||m.km||0).toLocaleString('pt-BR'))+' km'},
                        {label: '‚öôÔ∏è Cilindrada', value: (m.displacement||m.cilindradas||m.cc||'N/A')+'cc'}
                    ];
                    
                    specs.forEach(spec => {
                        const box = document.createElement('div');
                        box.style.cssText = 'background:rgba(255,255,255,0.05);padding:10px 8px;border-radius:10px';
                        
                        const label = document.createElement('div');
                        label.style.cssText = 'font-size:0.65rem;color:rgba(255,255,255,0.6);margin-bottom:4px';
                        label.textContent = spec.label;
                        
                        const value = document.createElement('div');
                        value.style.cssText = 'font-size:0.85rem;color:#fff;font-weight:600';
                        value.textContent = spec.value;
                        
                        box.appendChild(label);
                        box.appendChild(value);
                        grid.appendChild(box);
                    });
                    
                    content.appendChild(grid);
                    
                    // Bot√£o
                    const btn = document.createElement('button');
                    btn.style.cssText = 'width:100%;height:44px;background:linear-gradient(135deg,#ff6600,#ff8533);border:none;border-radius:12px;color:#fff;font-size:0.95rem;font-weight:700;cursor:pointer';
                    btn.textContent = 'üìÖ Agendar Visita';
                    btn.onclick = () => { localStorage.setItem('selectedMotoId', m.id); window.location.href = 'agendamento.html'; };
                    content.appendChild(btn);
                    
                    s.appendChild(content);
                    s.onclick = e => { if (e.target === s) { s.remove(); } };
                    document.body.appendChild(s);
                    // N√ÉO bloquear scroll em mobile
                    
                    console.log('‚úÖ GRID 2x2 - Bottom Sheet Ativado!');
                };
            }, 500);
        });
    }
    </script>
    
    <!-- FIX SCROLL MOBILE AP√ìS A√á√ïES - VERS√ÉO AGRESSIVA -->
    <script>
    if (window.innerWidth <= 1024) {
        function forceScrollMobile() {
            const html = document.documentElement;
            const body = document.body;
            
            // Remover classes bloqueadoras
            html.classList.remove('modal-open', 'no-scroll');
            body.classList.remove('modal-open', 'no-scroll');
            
            // For√ßar scroll
            html.style.setProperty('overflow', 'auto', 'important');
            html.style.setProperty('overflow-y', 'scroll', 'important');
            html.style.setProperty('overflow-x', 'hidden', 'important');
            html.style.setProperty('position', 'static', 'important');
            html.style.setProperty('height', 'auto', 'important');
            
            body.style.setProperty('overflow', 'auto', 'important');
            body.style.setProperty('overflow-y', 'scroll', 'important');
            body.style.setProperty('overflow-x', 'hidden', 'important');
            body.style.setProperty('position', 'static', 'important');
            body.style.setProperty('height', 'auto', 'important');
            body.style.setProperty('touch-action', 'pan-y', 'important');
        }
        
        // Executar imediatamente
        forceScrollMobile();
        
        // Executar a cada 500ms
        setInterval(forceScrollMobile, 500);
        
        // Executar quando p√°gina ficar vis√≠vel
        document.addEventListener('visibilitychange', () => {
            if (!document.hidden) {
                forceScrollMobile();
                console.log('‚úÖ Scroll restaurado (visibilitychange)');
            }
        });
        
        // Executar quando p√°gina receber foco
        window.addEventListener('focus', () => {
            forceScrollMobile();
            console.log('‚úÖ Scroll restaurado (focus)');
        });
        
        // Executar quando p√°gina for mostrada (volta do hist√≥rico)
        window.addEventListener('pageshow', () => {
            forceScrollMobile();
            console.log('‚úÖ Scroll restaurado (pageshow)');
        });
        
        console.log('üõ°Ô∏è Prote√ß√£o de scroll mobile AGRESSIVA ativada');
    }
    </script>
    
    <!-- FIX SCROLL MOBILE - DESATIVADO - Mobile delegado para outro dev -->
    <!--
    <script>
    (function() {
        function applyScrollFix() {
            if (window.innerWidth <= 1024) {
                const html = document.documentElement;
                const body = document.body;

                // Remover classes que podem travar scroll
                html.classList.remove('modal-open');
                body.classList.remove('modal-open');

                // Garantir scroll normal no mobile
                html.style.setProperty('overflow', 'auto', 'important');
                html.style.setProperty('overflow-x', 'hidden', 'important');
                html.style.setProperty('overflow-y', 'auto', 'important');
                html.style.setProperty('height', 'auto', 'important');
                html.style.setProperty('position', 'static', 'important');
                html.style.setProperty('touch-action', 'pan-y', 'important');

                body.style.setProperty('overflow', 'auto', 'important');
                body.style.setProperty('overflow-x', 'hidden', 'important');
                body.style.setProperty('overflow-y', 'auto', 'important');
                body.style.setProperty('height', 'auto', 'important');
                body.style.setProperty('position', 'static', 'important');
                body.style.setProperty('touch-action', 'pan-y', 'important');
                body.style.setProperty('-webkit-overflow-scrolling', 'touch', 'important');
                body.style.removeProperty('top');
                body.style.removeProperty('left');
            }
        }
        
        // Aguarda TUDO carregar (2 segundos ap√≥s load)
        window.addEventListener('load', function() {
            setTimeout(function() {
                console.log('üîß Aplicando fix de scroll...');
                applyScrollFix();
                console.log('‚úÖ Fix aplicado!');
                
                // REMOVER TODOS OS EVENT LISTENERS DE TOUCH
                const oldBody = document.body;
                const newBody = oldBody.cloneNode(true);
                oldBody.parentNode.replaceChild(newBody, oldBody);
                console.log('‚úÖ Event listeners de touch removidos!');
                
                // LOOP DESATIVADO - causava conflito com touch
                // Aplica apenas uma vez
            }, 2000);
        });
    })();
    </script>
    -->
    
    <style>
    
    /* Bot√£o de refresh fixo no topo direito do header */
    .header-btn-refresh {
        position: absolute !important;
        top: 0.5rem !important;
        right: 1rem !important;
        background: linear-gradient(135deg, #0066ff 0%, #0052cc 100%) !important;
        color: #ffffff !important;
        border: 1px solid #0066ff !important;
        padding: 0.3rem 0.5rem !important;
        border-radius: 50px !important;
        cursor: pointer !important;
        font-weight: 700 !important;
        font-size: 0.75rem !important;
        transition: all 0.3s ease !important;
        box-shadow: 0 4px 12px rgba(0, 102, 255, 0.3) !important;
        z-index: 10 !important;
        min-width: auto !important;
        height: auto !important;
        white-space: nowrap !important;
    }
    
    .header-btn-refresh:hover {
        transform: translateY(-2px) scale(1.05);
        box-shadow: 0 6px 20px rgba(0, 102, 255, 0.5);
        background: linear-gradient(135deg, #0052cc 0%, #003d99 100%);
    }
    
    .header-btn-refresh:active {
        transform: translateY(0) scale(0.98);
    }
    
    /* Painel lateral fixo para detalhes da moto */
    .side-panel {
        position: fixed;
        top: 0;
        left: 0;
        width: 380px;
        height: 100vh;
        background: linear-gradient(180deg, #1a1a1a 0%, #141414 100%);
        color: #fff;
        box-shadow: 4px 0 24px rgba(0, 0, 0, 0.5);
        z-index: 1001;
        display: flex;
        flex-direction: column;
        padding: 20px;
        transform: translateX(-100%);
        transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        opacity: 0;
        pointer-events: none;
        overflow-y: auto;
    }
    
    .side-panel.show {
        transform: translateX(0) !important;
        opacity: 1 !important;
        pointer-events: all !important;
    }
    
    .close-panel-btn {
        position: absolute;
        top: 10px;
        right: 10px;
        background: rgba(231, 76, 60, 0.8);
        color: white;
        border: none;
        border-radius: 50%;
        width: 35px;
        height: 35px;
        font-size: 1.5rem;
        cursor: pointer;
        transition: all 0.3s ease;
        z-index: 10;
    }
    
    .close-panel-btn:hover {
        background: rgba(192,57,43,1) !important;
        transform: rotate(90deg);
    }
    
    .panel-content {
        flex: 1;
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        gap: 16px;
    }
    .panel-image {
    width: 100%;
    height: 240px;
    background: #1a1a1a;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    margin-bottom: 12px;
    position: relative;
    }
    .panel-info h2 {
        font-size: 1.5em;
        margin-bottom: 12px;
        font-weight: 600;
    }
    .panel-details {
        width: 100%;
        margin-bottom: 16px;
    }
    .panel-details .detail-item {
        margin-bottom: 10px;
        font-size: 1.05em;
    }
    .panel-details .label {
        font-weight: 500;
        margin-right: 6px;
    }
    .panel-details .value {
        font-weight: 400;
    }
    .schedule-btn {
        background: #e67e22;
        color: #fff;
        border: none;
        padding: 12px 20px;
        border-radius: 6px;
        font-size: 1.1em;
        cursor: pointer;
        margin-top: 12px;
        transition: background 0.2s;
        font-weight: 600;
    }
    .schedule-btn:hover {
        background: #e74c3c;
    }
    
    /* Estilos para galeria no painel lateral */
    .panel-image .gallery-nav {
        font-size: 1.2rem;
    }
    
    .panel-image .gallery-counter {
        font-size: 0.85rem;
        padding: 0.3rem 0.6rem;
    }
    
    @media (max-width: 900px) {
        .side-panel {
            position: static;
            width: 100%;
            height: auto;
            border-radius: 0;
            box-shadow: none;
            padding: 12px 8px;
        }
    }
        /* Estilos adicionais para nova vers√£o */
        .reload-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #e74c3c;
            color: white;
            border: none;
            padding: 15px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 20px;
            box-shadow: 0 4px 15px rgba(231, 76, 60, 0.4);
            z-index: 1000;
            transition: all 0.3s;
        }
        
        .reload-btn:hover {
            transform: scale(1.1) rotate(180deg);
        }
        
        /* Modal Central de Detalhes */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: transparent; /* Sem overlay escuro */
            z-index: 99999;
            display: none;
            align-items: center;
            justify-content: flex-start;
            padding: 0;
            pointer-events: none; /* Permite intera√ß√£o com o cat√°logo */
        }
        
        .modal-overlay.show {
            display: flex;
        }
        
        /* Empurra o conte√∫do quando modal est√° aberto - APENAS DESKTOP */
        @media (min-width: 769px) {
            body.modal-open {
                padding-left: 450px !important;
                transition: padding-left 0.4s cubic-bezier(0.4, 0, 0.2, 1);
                box-sizing: border-box;
            }
        }
        
        /* FOR√áAR SCROLL - Prioridade m√°xima */
        html, body {
            overflow-y: scroll !important;
            overflow-x: hidden !important;
            height: auto !important;
        }
        
        html.modal-open, body.modal-open {
            overflow-y: scroll !important;
            overflow-x: hidden !important;
        }
        
        .modal-content {
            background: #ffffff;
            border-radius: 0 24px 24px 0;
            max-width: 450px;
            width: 450px;
            height: 100vh;
            max-height: 100vh;
            overflow: hidden;
            box-shadow: 8px 0 70px rgba(0, 0, 0, 0.3);
            animation: slideFromLeft 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            border-right: 3px solid #ff6600;
            display: flex;
            flex-direction: column;
            pointer-events: all; /* Modal √© clic√°vel */
        }
        
        .close-modal-btn {
            position: absolute;
            top: 12px;
            right: 12px;
            background: rgba(0, 0, 0, 0.7);
            border: none;
            color: #ffffff;
            font-size: 24px;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
            transition: all 0.3s ease;
            font-weight: 700;
        }
        
        .close-modal-btn:hover {
            background: #ff6600;
            color: #000000;
            transform: rotate(90deg) scale(1.15);
        }
        
        .modal-body {
            padding: 0;
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        
        .modal-image-container {
            width: 100%;
            height: 45%;
            flex-shrink: 0;
            position: relative;
            overflow: hidden;
            background: linear-gradient(135deg, #f5f5f5 0%, #e0e0e0 100%);
        }
        
        .modal-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }
        
        .modal-badge {
            position: absolute;
            bottom: 16px;
            left: 50%;
            transform: translateX(-50%);
            background: #ff6600;
            color: #000000;
            padding: 10px 24px;
            border-radius: 30px;
            font-weight: 800;
            font-size: 16px;
            box-shadow: 0 6px 20px rgba(255, 102, 0, 0.6);
        }
        
        .modal-info {
            flex: 1;
            padding: 28px 24px 24px;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
        }
        
        .modal-info h2 {
            font-size: 26px;
            font-weight: 800;
            color: #1a1a1a;
            margin-bottom: 20px;
            text-align: center;
            line-height: 1.3;
        }
        
        .modal-details {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 24px;
            flex: 1;
        }
        
        .modal-detail-item {
            background: #f8f9fa;
            border-left: 4px solid #ff6600;
            border-radius: 8px;
            padding: 14px 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.2s ease;
        }
        
        .modal-detail-item:hover {
            background: #fff4ed;
            transform: translateX(4px);
        }
        
        .modal-detail-label {
            font-size: 13px;
            font-weight: 600;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .modal-detail-value {
            font-size: 16px;
            font-weight: 700;
            color: #1a1a1a;
        }
        
        .modal-schedule-btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #ff6600 0%, #ff8533 100%);
            color: #000000;
            border: none;
            border-radius: 16px;
            font-size: 17px;
            font-weight: 800;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1.2px;
            box-shadow: 0 6px 20px rgba(255, 102, 0, 0.4);
            flex-shrink: 0;
        }
        
        .modal-schedule-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 28px rgba(255, 102, 0, 0.5);
        }
        
        .modal-schedule-btn:active {
            transform: translateY(-1px);
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(60px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        @keyframes slideFromLeft {
            from {
                opacity: 0;
                transform: translateX(-100%);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        @media (max-width: 768px) {
            body.modal-open {
                padding-left: 0 !important; /* N√ÉO empurrar em mobile - causa problema de scroll */
            }
            
            html, body {
                overflow-y: scroll !important;
                overflow-x: hidden !important;
            }
            
            .modal-content {
                max-height: 100vh;
                height: 100vh;
                border-radius: 0 16px 16px 0;
                width: 75vw;
                max-width: 75vw;
            }
            
            .modal-body {
                padding: 24px;
            }
            
            .modal-info h2 {
                font-size: 24px;
            }
            
            .modal-details {
                grid-template-columns: 1fr;
            }
        }
        
        .cache-info {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 8px 12px;
            border-radius: 5px;
            font-size: 11px;
            z-index: 100;
            pointer-events: none;
        }
        

        
        /* Ripple effect */
        .loading-ripple {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 150px;
            height: 150px;
            pointer-events: none;
        }
        
        .ripple-circle {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: 2px solid rgba(255, 122, 24, 0.4);
            border-radius: 50%;
            animation: ripple 2s ease-out infinite;
        }
        
        .ripple-circle:nth-child(2) {
            animation-delay: 0.5s;
        }
        
        .ripple-circle:nth-child(3) {
            animation-delay: 1s;
        }
        
        @keyframes ripple {
            0% {
                transform: scale(0.8);
                opacity: 1;
            }
            100% {
                transform: scale(1.5);
                opacity: 0;
            }
        }
        
        .error-display {
            background: #e74c3c;
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin: 20px;
            text-align: center;
        }
    </style>
    
    <!-- ü¶ä Firefox Performance Optimization -->
    <script src="firefox-performance-fix.js?v=20260114"></script>
    
    <!-- üõ°Ô∏è PROTE√á√ÉO SCROLL MOBILE - FOR√áA A CADA 1s -->
    <script>
    if (window.innerWidth <= 1024) {
        // Prote√ß√£o inicial
        function forceScrollMobile() {
            document.documentElement.style.setProperty('overflow', 'auto', 'important');
            document.documentElement.style.setProperty('overflow-y', 'auto', 'important');
            document.documentElement.style.setProperty('overflow-x', 'hidden', 'important');
            document.documentElement.style.setProperty('position', 'static', 'important');
            
            document.body.style.setProperty('overflow', 'auto', 'important');
            document.body.style.setProperty('overflow-y', 'auto', 'important');
            document.body.style.setProperty('overflow-x', 'hidden', 'important');
            document.body.style.setProperty('position', 'static', 'important');
            document.body.style.setProperty('touch-action', 'pan-y', 'important');
            
            // Remover classes bloqueadoras
            document.body.classList.remove('modal-open', 'no-scroll');
            document.documentElement.classList.remove('modal-open', 'no-scroll');
        }
        
        // Aplicar imediatamente
        forceScrollMobile();
        
        // Aplicar quando DOM carregar
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', forceScrollMobile);
        }
        
        // Repetir a cada 1 segundo para garantir
        setInterval(forceScrollMobile, 1000);
        
        console.log('üõ°Ô∏è Prote√ß√£o de scroll mobile ativada');
    }
    </script>
</head>
<body>
    <!-- Iniciar loading imediatamente -->
    <script>
        if (window.SmartLoading) {
            SmartLoading.show('Carregando cat√°logo...');
        }
    </script>
    
    <!-- Cache Info -->
    <div class="cache-info" id="cacheInfo">
        Nova Vers√£o - <span id="loadTime"></span>
    </div>

    <!-- Elementos decorativos animados -->
    <div class="decorative-elements">
        <div class="floating-shape shape-1"></div>
        <div class="floating-shape shape-2"></div>
        <div class="floating-shape shape-3"></div>
        <div class="floating-shape shape-4"></div>
        <div class="floating-shape shape-5"></div>
    </div>
    
    <!-- Header profissional com branding -->
    <header class="hero-header">
        <!-- Bot√£o de atualizar fixo no topo direito -->
        <button onclick="location.reload()" class="header-btn-refresh" title="Atualizar Cat√°logo">üîÑ</button>
        
        <div class="brand-container">
            <div class="brand-logo">
                <img src="PNG MD.png" alt="MacDavis Motos Logo" class="logo-image">
            </div>
            <div class="brand-content">
                <div class="brand-text">
                    <h1 class="main-title">MacDavis Motos</h1>
                    <p class="brand-tagline">Sua escolha em motocicletas</p>
                </div>
            </div>
        </div>
        
        <!-- User info -->
        <div class="user-info">
            <span>üë§ <span id="userName">Visitante</span></span>
            <div class="header-actions">
                <button onclick="window.location.href='meus-agendamentos.html'" class="header-btn" title="Gerenciar Agendamentos">üìÖ MEUS AGENDAMENTOS</button>
                <button onclick="logout()" class="header-btn">SAIR</button>
            </div>
        </div>
    </header>

    <!-- Filtros e busca -->
    <section class="filters-section">
        <div class="container">
            <div class="filters-controls">
                <div class="filter-group">
                        <h3>Filtrar por Estilo</h3>
                        <div class="filter-buttons">
                            <button class="filter-btn active" data-filter="all">Todos</button>
                            <button class="filter-btn" data-filter="scooter">Scooters</button>
                            <button class="filter-btn" data-filter="street">Streets</button>
                            <button class="filter-btn" data-filter="trail">Trail</button>
                            <button class="filter-btn" data-filter="alta-cilindrada">Esportiva</button>
                            <button class="filter-btn" data-filter="custom">Custom</button>
                        </div>
                    </div>
                    
                    <div class="filter-group">
                        <h3>Filtrar por Cilindrada</h3>
                        <div class="filter-buttons">
                            <button class="filter-btn-cil active" data-filter="all">Todas</button>
                            <button class="filter-btn-cil" data-filter="50-100">50-100cc</button>
                            <button class="filter-btn-cil" data-filter="110-190">110-190cc</button>
                            <button class="filter-btn-cil" data-filter="200-400">200-400cc</button>
                            <button class="filter-btn-cil" data-filter="500+">500cc+</button>
                        </div>
                    </div>
                    
                    <div class="search-group">
                        <h3 style="color: #ffffff;">üîç Buscar</h3>
                        <input type="text" id="searchInput" placeholder="Digite modelo, ano, cor..." />
                    </div>
                </div>
            </div>
        </section>

    <!-- Galeria de motocicletas -->
    <section class="gallery-section">
        <div class="container">
            <div class="gallery-grid" id="galleryGrid">
                <!-- Motocicletas ser√£o carregadas aqui via JavaScript -->
            </div>
        </div>
    </section>

    <!-- Painel lateral de detalhes da moto -->
    <div class="side-panel" id="sidePanel">
        <button class="close-panel-btn" onclick="clearSidePanel()">&times;</button>
        <div class="panel-content">
            <div class="panel-image" id="panelImageContainer">
                <img id="panelImage" src="" alt="Motocicleta" />
                <button class="gallery-nav prev" id="panelPrevBtn" onclick="navigateGallery(-1)">&#10094;</button>
                <button class="gallery-nav next" id="panelNextBtn" onclick="navigateGallery(1)">&#10095;</button>
                <div class="gallery-counter" id="panelCounter">1 / 1</div>
            </div>
            <div class="panel-info">
                <h2 id="panelTitle">Selecione uma motocicleta</h2>
                <div class="panel-details">
                    <div class="detail-item"><span class="label">Ano:</span> <span id="panelYear" class="value"></span></div>
                    <div class="detail-item"><span class="label">Cor:</span> <span id="panelColor" class="value"></span></div>
                    <div class="detail-item"><span class="label">Quilometragem:</span> <span id="panelMileage" class="value"></span></div>
                    <div class="detail-item"><span class="label">Cilindrada:</span> <span id="panelDisplacement" class="value"></span></div>
                </div>
                <button id="panelScheduleBtn" class="schedule-btn">üìÖ Agendar Visita</button>
            </div>
        </div>
    </div>

    <!-- Modal de Detalhes da Moto -->
    <div class="modal-overlay" id="modalOverlay">
        <div class="modal-content">
            <button class="close-modal-btn" id="closeModalBtn">&times;</button>
            <div class="modal-body">
                <div class="modal-image-container">
                    <img id="modalImage" src="" alt="Motocicleta" class="modal-image" />
                    <!-- Controles de galeria -->
                    <button class="gallery-nav prev" id="prevImageBtn" onclick="prevImage()" style="display: none;">‚óÄ</button>
                    <button class="gallery-nav next" id="nextImageBtn" onclick="nextImage()" style="display: none;">‚ñ∂</button>
                    <div class="gallery-counter" id="imageCounter" style="display: none;">1 / 1</div>
                </div>
                <div class="modal-info">
                    <h2 id="modalTitle">Honda Elite 125</h2>
                    <div class="modal-details">
                        <div class="modal-detail-item">
                            <span class="modal-detail-label">Ano</span>
                            <span id="modalYear" class="modal-detail-value">2025</span>
                        </div>
                        <div class="modal-detail-item">
                            <span class="modal-detail-label">Cor</span>
                            <span id="modalColor" class="modal-detail-value">Branca</span>
                        </div>
                        <div class="modal-detail-item">
                            <span class="modal-detail-label">Quilometragem</span>
                            <span id="modalMileage" class="modal-detail-value">0 km</span>
                        </div>
                        <div class="modal-detail-item">
                            <span class="modal-detail-label">Cilindrada</span>
                            <span id="modalDisplacement" class="modal-detail-value">125cc</span>
                        </div>
                    </div>
                    <button id="modalScheduleBtn" class="modal-schedule-btn">üìÖ Agendar Visita</button>
                </div>
            </div>
        </div>
    </div>

    <!-- üöÄ MOBILE CATALOG OPTIMIZER - Desabilitado (usando modal central) -->
    <!-- <script src="mobile-bottom-sheet-force.js?v=202601151259"></script> -->

    <script>
        // Sistema anti-cache ultra agressivo
        const VERSION = Date.now() + '-' + Math.random();
        // Application version (static, shows on mobile as readable APP_VERSION)
        const APP_VERSION = '1.1.0';
        let motorcycles = [];
        let filteredMotorcycles = [];
        let currentFilter = 'all';
        let currentEstiloFilter = 'all';
        let currentCilindradaFilter = 'all';
        
        // ========================================
        // üñºÔ∏è VARI√ÅVEIS DA GALERIA DE FOTOS
        // ========================================
        let currentImageIndex = 0;
        let currentMotoImages = [];
        
        // ========================================
        // ‚ö° OTIMIZA√á√ïES DE PERFORMANCE
        // ========================================
        
        // Intersection Observer para lazy loading inteligente
        let imageObserver;
        
        function setupLazyLoading() {
            // Configurar observer para carregar imagens apenas quando vis√≠veis
            if ('IntersectionObserver' in window) {
                imageObserver = new IntersectionObserver((entries, observer) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const img = entry.target;
                            const src = img.getAttribute('data-src');
                            if (src) {
                                img.src = src;
                                img.removeAttribute('data-src');
                                img.classList.remove('lazy-img');
                                observer.unobserve(img);
                            }
                        }
                    });
                }, {
                    rootMargin: '50px' // Carregar 50px antes de aparecer
                });
                
                // Observar todas as imagens lazy
                document.querySelectorAll('.lazy-img').forEach(img => {
                    imageObserver.observe(img);
                });
            } else {
                // Fallback: carregar todas imediatamente
                document.querySelectorAll('.lazy-img').forEach(img => {
                    const src = img.getAttribute('data-src');
                    if (src) img.src = src;
                });
            }
        }
        
        // Throttle para evitar execu√ß√µes excessivas
        function throttle(func, delay) {
            let lastCall = 0;
            return function(...args) {
                const now = new Date().getTime();
                if (now - lastCall < delay) return;
                lastCall = now;
                return func(...args);
            };
        }

        // Fun√ß√£o para formatar n√∫meros com pontos de milhar
        function formatarNumero(numero) {
            if (!numero && numero !== 0) return '0';
            // Remover pontos existentes e converter para n√∫mero
            const num = typeof numero === 'string' ? parseInt(numero.replace(/\./g, '')) : numero;
            // Formatar com pontos de milhar
            return num.toLocaleString('pt-BR');
        }

        // Atualizar info de vers√£o/cache (mostra vers√£o leg√≠vel em vez de timestamp)
        try {
            document.getElementById('loadTime').textContent = APP_VERSION;
        } catch (e) {
            // fallback to time if element missing
            try { document.getElementById('loadTime').textContent = new Date().toLocaleTimeString('pt-BR'); } catch(e){}
        }

        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('üöÄ Nova vers√£o do cat√°logo iniciada');
            
            // Loading j√° est√° ativo desde o in√≠cio do body
            SmartLoading.updateMessage('Buscando motocicletas...');
            
            try {
                // Verificar login
                checkUserLogin();
                
                SmartLoading.updateMessage('Buscando motocicletas...');
                
                // Carregar motocicletas
                await loadMotorcycles();
                
                SmartLoading.updateMessage('Preparando interface...');
                
                // Configurar interface
                setupFilters();
                setupSearch();
                setupShrinkingHeader();
                setupModalEvents();
                
                // Renderizar cat√°logo
                renderCatalog();
                
                // ‚ö° MOBILE: Preload das primeiras imagens (above the fold)
                if (window.innerWidth <= 768 && filteredMotorcycles.length > 0) {
                    const preloadCount = Math.min(4, filteredMotorcycles.length);
                    for (let i = 0; i < preloadCount; i++) {
                        if (filteredMotorcycles[i].image) {
                            const link = document.createElement('link');
                            link.rel = 'preload';
                            link.as = 'image';
                            link.href = filteredMotorcycles[i].image;
                            document.head.appendChild(link);
                        }
                    }
                }
                
                // Pequena pausa para garantir renderiza√ß√£o completa
                await new Promise(resolve => setTimeout(resolve, 300));
                
                // Esconder loading - tudo pronto!
                SmartLoading.hide();
                
                // Inicializar sistema de notifica√ß√µes Toast
                setTimeout(() => {
                    console.log('üîç [CATALOG] Verificando Toast...', {
                        toastExists: !!window.Toast,
                        toastType: typeof window.Toast,
                        notification: typeof Notification !== 'undefined' ? Notification.permission : 'n√£o suportado'
                    });
                    
                    if (window.Toast) {
                        console.log('‚úÖ Toast dispon√≠vel no cat√°logo!');
                        console.log('üîî Permiss√£o atual:', Toast.notificationPermission);
                        
                        // Sauda√ß√£o ao usu√°rio
                        const userData = localStorage.getItem('userData');
                        if (userData) {
                            const user = JSON.parse(userData);
                            Toast.success(`Bem-vindo, ${user.nome || 'Cliente'}! üèçÔ∏è`, 3000);
                        }
                        
                        // Mostrar banner pedindo permiss√£o se necess√°rio (mas s√≥ ap√≥s 5 segundos)
                        if (Toast.notificationPermission === 'default') {
                            setTimeout(() => {
                                console.log('üîî Mostrando banner de permiss√£o...');
                                Toast.showNotificationBanner();
                            }, 5000);
                        }
                    } else {
                        console.error('‚ùå Toast N√ÉO est√° dispon√≠vel no cat√°logo!');
                    }
                }, 1000);
                
            } catch (error) {
                console.error('Erro ao inicializar:', error);
                SmartLoading.hide();
                if (window.Toast) {
                    Toast.error('Erro ao carregar o cat√°logo. Por favor, recarregue a p√°gina.', 6000);
                }
            }
        });

        // Configurar header que encolhe no scroll
        function setupShrinkingHeader() {
            const header = document.querySelector('.hero-header');
            let ticking = false;
            let isScrolled = false;
            
            function updateHeader() {
                const scrollPos = window.pageYOffset;
                
                // Hysteresis: usa valores diferentes para subir e descer
                if (!isScrolled && scrollPos > 100) {
                    header.classList.add('scrolled');
                    isScrolled = true;
                } else if (isScrolled && scrollPos < 50) {
                    header.classList.remove('scrolled');
                    isScrolled = false;
                }
                
                ticking = false;
            }
            
            window.addEventListener('scroll', () => {
                if (!ticking) {
                    requestAnimationFrame(updateHeader);
                    ticking = true;
                }
            }, { passive: true });
        }
        
        // Configurar eventos do modal
        function setupModalEvents() {
            const modal = document.getElementById('modalOverlay');
            
            // Fechar modal ao clicar fora
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    closeModal();
                }
            });
            
            // Fechar modal com ESC
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && modal.classList.contains('show')) {
                    closeModal();
                }
            });
        }

        // Verificar login do usu√°rio
        function checkUserLogin() {
            const userData = localStorage.getItem('userData');
            if (!userData) {
                SmartLoading.navigateWithLoading('login.html');
                return;
            }
            
            const user = JSON.parse(userData);
            document.getElementById('userName').textContent = user.nome || 'Visitante';
        }

        // Logout
        function logout() {
            localStorage.removeItem('userData');
            SmartLoading.navigateWithLoading('login.html');
        }

        // Carregar motocicletas com sistema anti-cache
        async function loadMotorcycles() {
            console.log('üì° Carregando motocicletas...');
            
            try {
                // URL com m√∫ltiplos cache-busters
                const apiUrl = `/api/motorcycles?v=${VERSION}&cb=${Date.now()}&r=${Math.random()}`;
                
                console.log('üîó URL:', apiUrl);
                
                const response = await fetch(apiUrl, {
                    method: 'GET',
                    cache: 'no-store',
                    headers: {
                        'Cache-Control': 'no-cache, no-store, must-revalidate, max-age=0',
                        'Pragma': 'no-cache',
                        'Expires': '0',
                        'X-Requested-With': 'XMLHttpRequest'
                    }
                });

                console.log('üìä Status:', response.status);

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const data = await response.json();
                console.log('‚úÖ Dados recebidos:', data.length, 'motocicletas');

                // Filtrar dados - excluir MOTTUs do cat√°logo de cliente
                const allMotos = Array.isArray(data) ? data : [];
                motorcycles = allMotos.filter(moto => {
                    const marca = (moto.marca || '').toUpperCase();
                    const modelo = (moto.modelo || moto.name || moto.nome || '').toUpperCase();
                    // Excluir motos MOTTU
                    return !marca.includes('MOTTU') && !modelo.includes('MOTTU');
                });
                
                console.log('üèçÔ∏è Motos dispon√≠veis (sem MOTTU):', motorcycles.length);
                filteredMotorcycles = [...motorcycles];
                
                // Salvar backup local
                localStorage.setItem('motorcycles_backup', JSON.stringify(motorcycles));
                
            } catch (error) {
                console.error('‚ùå Erro:', error);
                
                // Notificar erro
                if (window.Toast) {
                    Toast.warning('Usando dados em cache. Algumas informa√ß√µes podem estar desatualizadas.', 5000);
                }
                
                // Tentar backup local
                const backup = localStorage.getItem('motorcycles_backup');
                if (backup) {
                    console.log('üì¶ Usando backup local...');
                    const allMotos = JSON.parse(backup);
                    // Filtrar MOTTUs tamb√©m do backup
                    motorcycles = allMotos.filter(moto => {
                        const marca = (moto.marca || '').toUpperCase();
                        const modelo = (moto.modelo || moto.name || moto.nome || '').toUpperCase();
                        return !marca.includes('MOTTU') && !modelo.includes('MOTTU');
                    });
                    filteredMotorcycles = [...motorcycles];
                } else {
                    // Dados de emerg√™ncia
                    console.log('üÜò Usando dados de emerg√™ncia...');
                    if (window.Toast) {
                        Toast.error('Erro ao carregar motocicletas. Usando dados de emerg√™ncia.', 6000);
                    }
                    motorcycles = [
                        {
                            id: 'emergency-1',
                            name: 'CB 250 TWISTER',
                            year: '2022/22',
                            color: 'Vermelha',
                            displacement: 250,
                            mileage_display: '5.600'
                        }
                    ];
                    filteredMotorcycles = [...motorcycles];
                }
            }
        }

        // Configurar filtros
        function setupFilters() {
            // Filtros de estilo
            const filterBtns = document.querySelectorAll('.filter-btn');
            filterBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    filterBtns.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    currentEstiloFilter = btn.dataset.filter;
                    applyAllFilters();
                });
            });
            
            // Filtros de cilindrada
            const filterBtnsCil = document.querySelectorAll('.filter-btn-cil');
            filterBtnsCil.forEach(btn => {
                btn.addEventListener('click', () => {
                    filterBtnsCil.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    currentCilindradaFilter = btn.dataset.filter;
                    applyAllFilters();
                });
            });
        }

        // Aplicar todos os filtros combinados
        function applyAllFilters() {
            let filtered = [...motorcycles];
            
            // Filtrar por estilo
            if (currentEstiloFilter && currentEstiloFilter !== 'all') {
                filtered = filtered.filter(moto => {
                    const tipo = (moto.type || moto.tipo || '').toLowerCase();
                    const categoria = (moto.categoria || '').toLowerCase();
                    const modelo = (moto.modelo || moto.model || '').toLowerCase();
                    const cilindrada = parseInt(moto.displacement || moto.cilindradas || moto.engine_cc || moto.cc || 0);
                    
                    if (currentEstiloFilter === 'scooter') {
                        return tipo === 'scooter' || categoria === 'scooter';
                    } else if (currentEstiloFilter === 'custom') {
                        return tipo === 'custom' || categoria === 'custom';
                    } else if (currentEstiloFilter === 'trail') {
                        return tipo === 'trail' || categoria === 'trail' || modelo.includes('nc');
                    } else if (currentEstiloFilter === 'alta-cilindrada') {
                        const isTrail = tipo === 'trail' || categoria === 'trail' || modelo.includes('nc');
                        return cilindrada >= 500 && !isTrail;
                    } else if (currentEstiloFilter === 'street') {
                        return cilindrada < 500 && tipo !== 'scooter' && categoria !== 'scooter' && tipo !== 'custom' && categoria !== 'custom' && tipo !== 'trail' && categoria !== 'trail';
                    }
                    return true;
                });
            }
            
            // Filtrar por cilindrada
            if (currentCilindradaFilter && currentCilindradaFilter !== 'all') {
                if (currentCilindradaFilter.includes('-')) {
                    const [min, max] = currentCilindradaFilter.split('-').map(n => parseInt(n));
                    filtered = filtered.filter(moto => {
                        const cilindrada = parseInt(moto.displacement || moto.cilindradas || moto.engine_cc || moto.cc || 0);
                        return cilindrada >= min && cilindrada <= max;
                    });
                } else if (currentCilindradaFilter.includes('+')) {
                    const min = parseInt(currentCilindradaFilter.replace('+', ''));
                    filtered = filtered.filter(moto => {
                        const cilindrada = parseInt(moto.displacement || moto.cilindradas || moto.engine_cc || moto.cc || 0);
                        return cilindrada >= min;
                    });
                }
            }
            
            filteredMotorcycles = filtered;
            renderCatalog();
        }

        // Aplicar filtro (mantido para compatibilidade)
        function applyFilter(filter) {
            currentFilter = filter;
            currentCilindradaFilter = filter;
            applyAllFilters();
        }

        // Configurar busca
        function setupSearch() {
            const searchInput = document.getElementById('searchInput');
            
            // ‚ö° OTIMIZA√á√ÉO: Throttle para evitar renderiza√ß√µes excessivas
            const throttledSearch = throttle((term) => {
                if (term === '') {
                    applyAllFilters();
                } else {
                    // Aplicar busca sobre os filtros atuais
                    let baseFiltered = [...motorcycles];
                    
                    // Aplicar filtros de estilo e cilindrada primeiro
                    if (currentEstiloFilter && currentEstiloFilter !== 'all') {
                        baseFiltered = baseFiltered.filter(moto => {
                            const tipo = (moto.type || moto.tipo || '').toLowerCase();
                            const categoria = (moto.categoria || '').toLowerCase();
                            const modelo = (moto.modelo || moto.model || '').toLowerCase();
                            const cilindrada = parseInt(moto.displacement || moto.cilindradas || moto.engine_cc || moto.cc || 0);
                            
                            if (currentEstiloFilter === 'scooter') {
                                return tipo === 'scooter' || categoria === 'scooter';
                            } else if (currentEstiloFilter === 'custom') {
                                return tipo === 'custom' || categoria === 'custom';
                            } else if (currentEstiloFilter === 'trail') {
                                return tipo === 'trail' || categoria === 'trail' || modelo.includes('nc');
                            } else if (currentEstiloFilter === 'alta-cilindrada') {
                                const isTrail = tipo === 'trail' || categoria === 'trail' || modelo.includes('nc');
                                return cilindrada >= 500 && !isTrail;
                            } else if (currentEstiloFilter === 'street') {
                                return cilindrada < 500 && tipo !== 'scooter' && categoria !== 'scooter' && tipo !== 'custom' && categoria !== 'custom' && tipo !== 'trail' && categoria !== 'trail';
                            }
                            return true;
                        });
                    }
                    
                    if (currentCilindradaFilter && currentCilindradaFilter !== 'all') {
                        if (currentCilindradaFilter.includes('-')) {
                            const [min, max] = currentCilindradaFilter.split('-').map(n => parseInt(n));
                            baseFiltered = baseFiltered.filter(moto => {
                                const cilindrada = parseInt(moto.displacement || moto.cilindradas || moto.engine_cc || moto.cc || 0);
                                return cilindrada >= min && cilindrada <= max;
                            });
                        } else if (currentCilindradaFilter.includes('+')) {
                            const min = parseInt(currentCilindradaFilter.replace('+', ''));
                            baseFiltered = baseFiltered.filter(moto => {
                                const cilindrada = parseInt(moto.displacement || moto.cilindradas || moto.engine_cc || moto.cc || 0);
                                return cilindrada >= min;
                            });
                        }
                    }
                    
                    // Ent√£o aplicar a busca por texto
                    filteredMotorcycles = baseFiltered.filter(moto => {
                        const searchableText = [
                            moto.name || '',
                            moto.marca || '',
                            moto.modelo || '',
                            moto.color || moto.cor || '',
                            moto.year || moto.ano || '',
                            moto.desc || ''
                        ].join(' ').toLowerCase();
                        
                        return searchableText.includes(term);
                    });
                    renderCatalog();
                }
            }, 100); // 100ms = mais responsivo
            
            searchInput.addEventListener('input', (e) => {
                const term = e.target.value.toLowerCase().trim();
                throttledSearch(term);
            });
        }

        // Renderizar cat√°logo
        function renderCatalog() {
            const grid = document.getElementById('galleryGrid');
            
            console.log('üé® Renderizando cat√°logo...', {
                totalMotorcycles: motorcycles.length,
                filteredMotorcycles: filteredMotorcycles.length,
                currentFilter: currentFilter
            });
            
            if (filteredMotorcycles.length === 0) {
                grid.innerHTML = `
                    <div class="error-display">
                        <h3>üîç Nenhuma motocicleta encontrada</h3>
                        <p>Tente ajustar os filtros ou termo de busca</p>
                        <button onclick="forceReload()" class="btn">üîÑ Recarregar</button>
                    </div>
                `;
                return;
            }
            
            // Ordenar motos seguindo a l√≥gica do admin
            const motosSorted = [...filteredMotorcycles].sort((a, b) => {
                // Fun√ß√£o para determinar categoria
                const getCategoria = (moto) => {
                    const tipo = (moto.type || moto.tipo || '').toLowerCase();
                    const categoria = (moto.categoria || '').toLowerCase();
                    const modelo = (moto.modelo || moto.model || '').toLowerCase();
                    const cilindrada = parseInt(moto.displacement || moto.cilindradas || moto.engine_cc || moto.cc || 0);
                    
                    if (tipo === 'scooter' || categoria === 'scooter') return 1;
                    if (tipo === 'custom' || categoria === 'custom') return 4;
                    if (tipo === 'trail' || categoria === 'trail' || modelo.includes('nc')) return 5;
                    if (cilindrada >= 500) return 3;
                    return 2;
                };
                
                const catA = getCategoria(a);
                const catB = getCategoria(b);
                
                if (catA !== catB) return catA - catB;
                
                const cilA = parseInt(a.displacement || a.cilindradas || a.engine_cc || a.cc || 0);
                const cilB = parseInt(b.displacement || b.cilindradas || b.engine_cc || b.cc || 0);
                if (cilA !== cilB) return cilA - cilB;
                
                const anoA = parseInt(a.year || a.ano || 0);
                const anoB = parseInt(b.year || b.ano || 0);
                return anoA - anoB;
            });
            
            // ‚ö° OTIMIZA√á√ÉO: Renderizar em batches para evitar lag
            grid.innerHTML = ''; // Limpar primeiro
            
            // Detectar mobile para ajustar batch size
            const isMobile = window.innerWidth <= 768;
            const BATCH_SIZE = isMobile ? 4 : 6; // Menos cards por batch no mobile
            let currentBatch = 0;
            
            function renderBatch() {
                const start = currentBatch * BATCH_SIZE;
                const end = Math.min(start + BATCH_SIZE, motosSorted.length);
                const fragment = document.createDocumentFragment();
                
                for (let i = start; i < end; i++) {
                    const moto = motosSorted[i];
                    const nome = moto.marca ? `${moto.marca} ${moto.modelo || moto.name || moto.nome}` : (moto.name || moto.nome || 'Sem nome');
                    const ano = moto.ano || moto.year || 'N/A';
                    const cor = moto.cor || moto.color || 'N/A';
                    const kmRaw = moto.mileage_display || moto.quilometragem || moto.mileage || 0;
                    const km = formatarNumero(kmRaw);
                    const cilindrada = moto.displacement || moto.cilindradas || moto.engine_cc || moto.cc || '0';
                    
                    const cardDiv = document.createElement('div');
                    cardDiv.className = 'moto-card';
                    cardDiv.setAttribute('data-moto-id', moto.id);
                    // Mobile: anima√ß√£o mais r√°pida e menos delay
                    cardDiv.style.animationDelay = isMobile ? `${i * 0.02}s` : `${i * 0.05}s`;
                    
                    cardDiv.innerHTML = `
                        <div class="moto-image">
                            ${moto.image ? 
                                `<img data-src="${moto.image}?v=${VERSION}" alt="${nome}" 
                                     loading="${i < 4 ? 'eager' : 'lazy'}" 
                                     decoding="async" 
                                     fetchpriority="${i < 4 ? 'high' : 'auto'}"
                                     class="lazy-img" />` :
                                `<div class="no-image">üèçÔ∏è Sem Imagem</div>`
                            }
                            <div class="moto-badge">${cilindrada}cc</div>
                        </div>
                        
                        <div class="moto-info">
                            <h3 class="moto-title">${nome}</h3>
                            
                            <div class="moto-details">
                                <div class="detail-row">
                                    <span class="detail-label">Ano:</span>
                                    <span class="detail-value">${ano}</span>
                                </div>
                                <div class="detail-row">
                                    <span class="detail-label">Cor:</span>
                                    <span class="detail-value">${cor}</span>
                                </div>
                                <div class="detail-row">
                                    <span class="detail-label">KM:</span>
                                    <span class="detail-value">${km}</span>
                                </div>
                                <div class="detail-row">
                                    <span class="detail-label">Cilindrada:</span>
                                    <span class="detail-value">${cilindrada}</span>
                                </div>
                            </div>
                            
                            <button class="view-btn" onclick="openMotoModal('${moto.id}')">
                                <span>üëÅÔ∏è</span>
                                Ver Detalhes
                            </button>
                        </div>
                    `;
                    
                    fragment.appendChild(cardDiv);
                }
                
                grid.appendChild(fragment);
                currentBatch++;
                
                // Continuar renderizando pr√≥ximo batch
                if (end < motosSorted.length) {
                    requestAnimationFrame(renderBatch);
                } else {
                    console.log('‚úÖ Cat√°logo renderizado:', motosSorted.length, 'motos');
                    setupLazyLoading(); // Configurar lazy loading ap√≥s renderizar
                }
            }
            
            // Iniciar renderiza√ß√£o
            requestAnimationFrame(renderBatch);
        }

        // ========================================
        // üñºÔ∏è SISTEMA DE GALERIA DE FOTOS DO MODAL
        // ========================================
        
        function updateModalImage() {
            console.log('üñºÔ∏è UPDATE MODAL IMAGE CHAMADO!');
            console.log('üìç √çndice atual:', currentImageIndex);
            console.log('üìç Total de imagens:', currentMotoImages.length);
            
            const modalImage = document.getElementById('modalImage');
            const imageCounter = document.getElementById('imageCounter');
            const prevBtn = document.getElementById('prevImageBtn');
            const nextBtn = document.getElementById('nextImageBtn');
            
            console.log('üîç Elementos encontrados:', {
                modalImage: !!modalImage,
                imageCounter: !!imageCounter,
                prevBtn: !!prevBtn,
                nextBtn: !!nextBtn
            });
            
            // Se n√£o tem imagens
            if (currentMotoImages.length === 0) {
                console.log('‚ùå SEM FOTO - escondendo imagem');
                if (modalImage) {
                    modalImage.style.display = 'none';
                    modalImage.removeAttribute('src');
                }
                if (imageCounter) imageCounter.style.display = 'none';
                if (prevBtn) prevBtn.style.display = 'none';
                if (nextBtn) nextBtn.style.display = 'none';
                return;
            }
            
            // Tem imagens - carregar atual
            console.log('‚úÖ COM FOTO - carregando imagem', currentImageIndex + 1, 'de', currentMotoImages.length);
            console.log('üîó URL:', currentMotoImages[currentImageIndex]);
            // Usar cache do navegador - remover Date.now() para evitar recarga
            const imageUrl = `${currentMotoImages[currentImageIndex]}?v=${VERSION}`;
            
            if (modalImage) {
                // Transi√ß√£o suave
                modalImage.style.opacity = '0';
                
                // Pequeno delay para suavizar transi√ß√£o
                setTimeout(() => {
                    modalImage.src = imageUrl;
                    modalImage.onload = () => {
                        modalImage.style.display = 'block';
                        modalImage.style.opacity = '1';
                    };
                    modalImage.onerror = () => { 
                        console.error('‚ùå Erro ao carregar imagem');
                        modalImage.style.display = 'none';
                    };
                }, 150); // 150ms para transi√ß√£o suave
            }
            
            // Atualizar contador
            if (imageCounter) {
                if (currentMotoImages.length > 1) {
                    imageCounter.textContent = `${currentImageIndex + 1} / ${currentMotoImages.length}`;
                    imageCounter.style.cssText = `
                        display: block !important;
                        position: absolute !important;
                        bottom: 0.5rem !important;
                        left: 50% !important;
                        transform: translateX(-50%) !important;
                        background: rgba(0, 0, 0, 0.6) !important;
                        color: white !important;
                        padding: 0.4rem 0.8rem !important;
                        border-radius: 4px !important;
                        font-size: 0.85rem !important;
                        font-weight: 600 !important;
                        z-index: 9999 !important;
                        backdrop-filter: blur(5px) !important;
                    `;
                    console.log('‚úÖ CONTADOR:', imageCounter.textContent);
                } else {
                    imageCounter.style.display = 'none';
                }
            }
            
            // Atualizar bot√µes
            if (prevBtn && nextBtn) {
                if (currentMotoImages.length > 1) {
                    // Aplicar estilos inline para sobrescrever CSS
                    prevBtn.style.cssText = `
                        display: flex !important;
                        position: absolute !important;
                        left: 0.5rem !important;
                        top: 50% !important;
                        transform: translateY(-50%) !important;
                        background: rgba(0, 0, 0, 0.5) !important;
                        color: white !important;
                        border: none !important;
                        padding: 0.5rem !important;
                        cursor: pointer !important;
                        font-size: 1.5rem !important;
                        z-index: 9999 !important;
                        border-radius: 4px !important;
                        width: 40px !important;
                        height: 40px !important;
                        align-items: center !important;
                        justify-content: center !important;
                        pointer-events: auto !important;
                        transition: all 0.2s ease !important;
                        backdrop-filter: blur(5px) !important;
                    `;
                    
                    nextBtn.style.cssText = `
                        display: flex !important;
                        position: absolute !important;
                        right: 0.5rem !important;
                        top: 50% !important;
                        transform: translateY(-50%) !important;
                        background: rgba(0, 0, 0, 0.5) !important;
                        color: white !important;
                        border: none !important;
                        padding: 0.5rem !important;
                        cursor: pointer !important;
                        font-size: 1.5rem !important;
                        z-index: 9999 !important;
                        border-radius: 4px !important;
                        width: 40px !important;
                        height: 40px !important;
                        align-items: center !important;
                        justify-content: center !important;
                        pointer-events: auto !important;
                        transition: all 0.2s ease !important;
                        backdrop-filter: blur(5px) !important;
                    `;
                    
                    // Hover effect
                    prevBtn.addEventListener('mouseenter', () => {
                        if (!prevBtn.disabled) prevBtn.style.background = 'rgba(255, 102, 0, 0.8)';
                    });
                    prevBtn.addEventListener('mouseleave', () => {
                        prevBtn.style.background = 'rgba(0, 0, 0, 0.5)';
                    });
                    
                    nextBtn.addEventListener('mouseenter', () => {
                        if (!nextBtn.disabled) nextBtn.style.background = 'rgba(255, 102, 0, 0.8)';
                    });
                    nextBtn.addEventListener('mouseleave', () => {
                        nextBtn.style.background = 'rgba(0, 0, 0, 0.5)';
                    });
                    
                    prevBtn.disabled = currentImageIndex === 0;
                    nextBtn.disabled = currentImageIndex === currentMotoImages.length - 1;
                    
                    // Adicionar opacidade nos disabled
                    if (prevBtn.disabled) prevBtn.style.opacity = '0.3';
                    else prevBtn.style.opacity = '1';
                    if (nextBtn.disabled) nextBtn.style.opacity = '0.3';
                    else nextBtn.style.opacity = '1';
                    
                    console.log('‚úÖ BOT√ïES MOSTRADOS!');
                } else {
                    prevBtn.style.display = 'none';
                    nextBtn.style.display = 'none';
                }
            }
            console.log('='.repeat(50));
        }
        
        function prevImage() {
            console.log('‚óÄÔ∏è PREV IMAGE!');
            if (currentImageIndex > 0) {
                currentImageIndex--;
                updateModalImage();
                preloadAdjacentImages(); // ‚ö° Preload para navega√ß√£o r√°pida
            }
        }
        
        function nextImage() {
            console.log('‚ñ∂Ô∏è NEXT IMAGE!');
            if (currentImageIndex < currentMotoImages.length - 1) {
                currentImageIndex++;
                updateModalImage();
                preloadAdjacentImages(); // ‚ö° Preload para navega√ß√£o r√°pida
            }
        }
        
        // ‚ö° Preload TODAS as imagens ao abrir galeria
        let imageCache = {};
        
        function preloadAllGalleryImages() {
            if (currentMotoImages.length === 0) return;
            
            console.log('üìã Preloading', currentMotoImages.length, 'imagens da galeria...');
            
            currentMotoImages.forEach((url, index) => {
                if (!imageCache[url]) {
                    const img = new Image();
                    img.onload = () => {
                        imageCache[url] = true;
                        console.log('‚úÖ Imagem', index + 1, 'carregada');
                    };
                    img.src = `${url}?v=${VERSION}`;
                }
            });
        }
        
        // Preload das imagens adjacentes para navega√ß√£o instant√¢nea (mantido como backup)
        function preloadAdjacentImages() {
            const preloadIndexes = [];
            
            // Pr√≥xima imagem
            if (currentImageIndex + 1 < currentMotoImages.length) {
                preloadIndexes.push(currentImageIndex + 1);
            }
            
            // Imagem anterior
            if (currentImageIndex - 1 >= 0) {
                preloadIndexes.push(currentImageIndex - 1);
            }
            
            preloadIndexes.forEach(index => {
                const url = currentMotoImages[index];
                if (!imageCache[url]) {
                    const img = new Image();
                    img.src = `${url}?v=${VERSION}`;
                    imageCache[url] = true;
                }
            });
        }

        // Configurar modal
        // Preencher painel lateral com dados da moto
        let currentMoto = null;
        
        // Fun√ß√£o para abrir modal (nova - usa o modal overlay)
        function openMotoModal(motoId) {
            console.log('='.repeat(50));
            console.log('üîç ABRINDO MODAL PARA MOTO:', motoId);
            
            // ‚ö° Limpar imagem anterior para evitar flash
            const modalImg = document.getElementById('modalImage');
            if (modalImg) {
                modalImg.style.opacity = '0';
                modalImg.src = '';
            }
            
            const moto = motorcycles.find(m => m.id === motoId);
            
            if (!moto) {
                console.error('‚ùå MOTO N√ÉO ENCONTRADA!');
                return;
            }
            
            console.log('‚úÖ MOTO ENCONTRADA:', moto.name || moto.nome);
            console.log('üìã Dados da moto:', {
                image: moto.image,
                imagem2: moto.imagem2,
                imagem3: moto.imagem3,
                imagem4: moto.imagem4,
                images: moto.images
            });
            
            // Coletar todas as imagens dispon√≠veis
            currentMotoImages = [];
            currentImageIndex = 0;
            
            // Verificar array images (novo formato)
            if (moto.images && Array.isArray(moto.images) && moto.images.length > 0) {
                console.log('üîÑ Usando array IMAGES (novo formato)');
                currentMotoImages = moto.images.filter(img => img && img.trim() !== '');
            } else {
                console.log('üîÑ Usando campos individuais (formato antigo)');
                // Formato antigo (image, imagem2, etc)
                if (moto.image) currentMotoImages.push(moto.image);
                if (moto.imagem2) currentMotoImages.push(moto.imagem2);
                if (moto.imagem3) currentMotoImages.push(moto.imagem3);
                if (moto.imagem4) currentMotoImages.push(moto.imagem4);
            }
            
            console.log('üì∏ TOTAL DE IMAGENS COLETADAS:', currentMotoImages.length);
            console.log('üì∏ ARRAY DE IMAGENS:', currentMotoImages);
            
            // Armazenar moto atual
            currentMoto = moto;
            
            const title = (moto.marca ? moto.marca + ' ' : '') + (moto.modelo || moto.name || moto.nome || 'Motocicleta');
            const displacement = (moto.displacement || moto.cilindradas || moto.engine_cc || moto.cc || '0') + 'cc';
            
            // Preencher dados do modal
            document.getElementById('modalTitle').textContent = title;
            document.getElementById('modalYear').textContent = moto.ano || moto.year || 'N/A';
            document.getElementById('modalColor').textContent = moto.cor || moto.color || 'N/A';
            
            const kmValue = moto.mileage_display || moto.quilometragem || moto.mileage || moto.km || 0;
            document.getElementById('modalMileage').textContent = formatarNumero(kmValue) + ' km';
            document.getElementById('modalDisplacement').textContent = displacement;
            
            // Atualizar alt da imagem
            const modalImage = document.getElementById('modalImage');
            if (modalImage) modalImage.alt = title;
            
            // ========================================
            // üñºÔ∏è ATUALIZAR GALERIA DE FOTOS
            // ========================================
            updateModalImage();
            
            // ‚ö° Preload TODAS as imagens da galeria em background
            setTimeout(() => {
                preloadAllGalleryImages();
            }, 100); // Pequeno delay para n√£o atrapalhar a abertura do modal
            
            // Configurar bot√£o de agendamento
            const scheduleBtn = document.getElementById('modalScheduleBtn');
            if (scheduleBtn) {
                scheduleBtn.onclick = () => {
                    closeModal();
                    scheduleVisit(motoId);
                };
            }
            
            // Mostrar modal
            const modalOverlay = document.getElementById('modalOverlay');
            console.log('üì¶ Modal element:', modalOverlay);
            modalOverlay.classList.add('show');
            // Bloquear scroll APENAS em desktop (> 900px)
            if (window.innerWidth > 900) {
                if (typeof window.lockBodyScrollSafe === 'function') window.lockBodyScrollSafe(); else document.body.style.overflow = 'hidden';
            }
            console.log('‚úÖ Modal exibido!');
        }
        
        // Fun√ß√£o para fechar modal
        function closeModal() {
            document.getElementById('modalOverlay').classList.remove('show');
            // Restaurar scroll APENAS em desktop
            if (window.innerWidth > 900) {
                if (typeof window.unlockBodyScrollSafe === 'function') window.unlockBodyScrollSafe(); else document.body.style.overflow = 'auto';
            }
            currentMoto = null;
            currentImageIndex = 0;
        }
        
        // Atualizar galeria do modal
        function updateModalGallery() {
            if (!currentMoto) return;
            
            const images = currentMoto.images && currentMoto.images.length > 0 
                ? currentMoto.images 
                : (currentMoto.image ? [currentMoto.image] : []);
            
            // Atualizar imagem
            const modalImage = document.getElementById('modalImage');
            if (images.length > 0) {
                modalImage.src = images[currentImageIndex];
            }
            
            // Controles de navega√ß√£o
            const prevBtn = document.getElementById('modalPrevBtn');
            const nextBtn = document.getElementById('modalNextBtn');
            const counter = document.getElementById('modalCounter');
            
            if (images.length > 1) {
                prevBtn.style.display = 'flex';
                nextBtn.style.display = 'flex';
                counter.style.display = 'block';
                counter.textContent = `${currentImageIndex + 1} / ${images.length}`;
                
                prevBtn.disabled = currentImageIndex === 0;
                nextBtn.disabled = currentImageIndex === images.length - 1;
            } else {
                prevBtn.style.display = 'none';
                nextBtn.style.display = 'none';
                counter.style.display = 'none';
            }
        }
        
        // Navegar pela galeria do modal
        function navigateModalGallery(direction) {
            if (!currentMoto) return;
            
            const images = currentMoto.images && currentMoto.images.length > 0 
                ? currentMoto.images 
                : (currentMoto.image ? [currentMoto.image] : []);
            
            currentImageIndex += direction;
            
            if (currentImageIndex < 0) currentImageIndex = 0;
            if (currentImageIndex >= images.length) currentImageIndex = images.length - 1;
            
            updateModalGallery();
        }
        
        function openMotoPanel(motoId) {
            const moto = motorcycles.find(m => m.id === motoId);
            if (!moto) {
                if (typeof Toast !== 'undefined') {
                    Toast.error('Motocicleta n√£o encontrada.');
                } else {
                    console.error('Motocicleta n√£o encontrada.');
                }
                return;
            }
            
            console.log('üéØ Abrindo painel lateral para:', moto);
            
            // Armazenar moto atual e resetar √≠ndice
            currentMoto = moto;
            currentImageIndex = 0;
            
            // Preencher informa√ß√µes do painel
            const title = (moto.marca ? moto.marca + ' ' : '') + (moto.modelo || moto.name || moto.nome || 'Motocicleta');
            const displacement = (moto.displacement || moto.cilindradas || moto.engine_cc || moto.cc || '0') + 'cc';
            
            document.getElementById('panelTitle').textContent = title;
            document.getElementById('panelYear').textContent = moto.ano || moto.year || 'N/A';
            document.getElementById('panelColor').textContent = moto.cor || moto.color || 'N/A';
            
            const kmValue = moto.mileage_display || moto.quilometragem || moto.mileage || moto.km || 0;
            document.getElementById('panelMileage').textContent = formatarNumero(kmValue) + ' km';
            document.getElementById('panelDisplacement').textContent = displacement;
            
            // Atualizar galeria de imagens
            updateGalleryDisplay();
            
            // Configurar bot√£o agendar
            const scheduleBtn = document.getElementById('panelScheduleBtn');
            scheduleBtn.onclick = () => {
                clearSidePanel();
                scheduleVisit(motoId);
            };
            
            // Mostrar painel lateral
            const sidePanel = document.getElementById('sidePanel');
            sidePanel.classList.add('show');
            
            console.log('‚úÖ Painel lateral aberto com galeria!');
        }
        
        // Atualizar exibi√ß√£o da galeria
        function updateGalleryDisplay() {
            if (!currentMoto) return;
            
            // Construir array de imagens (usar images se existir, sen√£o usar apenas a image principal)
            const images = currentMoto.images && currentMoto.images.length > 0 
                ? currentMoto.images 
                : (currentMoto.image ? [currentMoto.image] : []);
            
            // Atualizar imagem atual
            const panelImage = document.getElementById('panelImage');
            if (images.length > 0) {
                panelImage.src = images[currentImageIndex] + '?v=' + VERSION;
                panelImage.style.display = 'block';
            } else {
                panelImage.src = '';
                panelImage.style.display = 'none';
            }
            
            // Mostrar/ocultar controles de navega√ß√£o
            const prevBtn = document.getElementById('panelPrevBtn');
            const nextBtn = document.getElementById('panelNextBtn');
            const counter = document.getElementById('panelCounter');
            
            if (images.length > 1) {
                prevBtn.style.display = 'flex';
                nextBtn.style.display = 'flex';
                counter.style.display = 'block';
                counter.textContent = `${currentImageIndex + 1} / ${images.length}`;
                
                // Habilitar/desabilitar bot√µes conforme necess√°rio
                prevBtn.disabled = currentImageIndex === 0;
                nextBtn.disabled = currentImageIndex === images.length - 1;
            } else {
                prevBtn.style.display = 'none';
                nextBtn.style.display = 'none';
                counter.style.display = 'none';
            }
        }
        
        // Navegar pela galeria
        function navigateGallery(direction) {
            if (!currentMoto) return;
            
            const images = currentMoto.images && currentMoto.images.length > 0 
                ? currentMoto.images 
                : (currentMoto.image ? [currentMoto.image] : []);
            
            currentImageIndex += direction;
            
            // Garantir que o √≠ndice est√° dentro dos limites
            if (currentImageIndex < 0) currentImageIndex = 0;
            if (currentImageIndex >= images.length) currentImageIndex = images.length - 1;
            
            updateGalleryDisplay();
        }

        // Limpar painel lateral
        function clearSidePanel() {
            currentMoto = null;
            currentImageIndex = 0;
            
            // Esconder o painel com anima√ß√£o
            const sidePanel = document.getElementById('sidePanel');
            sidePanel.classList.remove('show');
            
            // Limpar conte√∫do ap√≥s a anima√ß√£o
            setTimeout(() => {
                document.getElementById('panelImage').src = '';
                document.getElementById('panelTitle').textContent = 'Selecione uma motocicleta';
                document.getElementById('panelYear').textContent = '';
                document.getElementById('panelColor').textContent = '';
                document.getElementById('panelMileage').textContent = '';
                document.getElementById('panelDisplacement').textContent = '';
                document.getElementById('panelScheduleBtn').style.display = 'none';
                document.getElementById('panelPrevBtn').style.display = 'none';
                document.getElementById('panelNextBtn').style.display = 'none';
                document.getElementById('panelCounter').style.display = 'none';
            }, 400);
        }

        // Agendar visita (removida fun√ß√£o closeModal duplicada)
        function setupModalEvents() {
            // Fechar ao clicar no bot√£o X
            document.getElementById('closeModalBtn').addEventListener('click', closeModal);
            
            // Fechar ao clicar no overlay
            document.getElementById('modalOverlay').addEventListener('click', (e) => {
                if (e.target.id === 'modalOverlay') {
                    closeModal();
                }
            });
            
            // Fechar com ESC
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    const modal = document.getElementById('modalOverlay');
                    if (modal && modal.classList.contains('show')) {
                        closeModal();
                    }
                }
            });
        }

        function scheduleVisit(motoId) {
            const moto = motorcycles.find(m => m.id === motoId);
            
            if (moto) {
                localStorage.setItem('selectedMotoId', motoId);
                localStorage.setItem('selectedMotoData', JSON.stringify(moto));
                
                // Notificar sucesso
                if (window.Toast) {
                    Toast.success(`${moto.name || moto.nome || 'Moto'} selecionada! Redirecionando para agendamento...`, 2000);
                }
                
                // Anima√ß√£o de fade out
                document.body.style.transition = 'opacity 0.3s ease-out';
                document.body.style.opacity = '0';
                
                setTimeout(() => {
                    window.location.href = 'agendamento.html';
                }, 300);
            } else {
                if (window.Toast) {
                    Toast.error('Erro ao selecionar motocicleta. Tente novamente.', 4000);
                }
            }
        }

        // For√ßar reload
        function forceReload() {
            console.log('üîÑ For√ßando reload...');
            
            // Limpar cache
            localStorage.removeItem('motorcycles_backup');
            
            if ('caches' in window) {
                caches.keys().then(names => {
                    names.forEach(name => caches.delete(name));
                    location.reload(true);
                });
            } else {
                location.reload(true);
            }
        }

        // Auto-refresh a cada 5 minutos
        setInterval(() => {
            console.log('‚è∞ Auto-refresh executado');
            loadMotorcycles().then(() => {
                applyFilter(currentFilter);
            });
        }, 300000);
    </script>
    
    <!-- üéØ Sistema de Notifica√ß√µes Toast -->
    <script src="toast-notifications.js?v=20260116"></script>
    
    <!-- Sistema de Transi√ß√µes -->
    <!-- TEMPORARIAMENTE DESATIVADO PARA TESTE DE SCROLL -->
    <!-- <script src="page-transitions.js?v=20260104c"></script> -->
    
    <!-- üì± MOBILE UX ENHANCEMENT -->
    <!-- TEMPORARIAMENTE DESATIVADO PARA TESTE DE SCROLL -->
    <!-- <script src="mobile-ux.js?v=20260104c"></script> -->
</body>
</html>